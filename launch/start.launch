<?xml version="1.0" encoding="UTF-8"?>
<launch>
  <arg name="world" default="$(find-pkg-share roselito_gazebo)/worlds/willow_garage.world"/>
  <include file="$(find-pkg-share gazebo_ros)/launch/gzserver.launch.py">
    <arg name="world" value="$(var world)"/>
  </include>
  <include file="$(find-pkg-share gazebo_ros)/launch/gzclient.launch.py">
    <arg name="gui_required" value="true"/>
  </include>

  <arg name="model" default="$(find-pkg-share roselito_gazebo)/urdf/roselito.xacro"/>
  <node name="robot_state_publisher" pkg="robot_state_publisher" exec="robot_state_publisher">
    <param name="robot_description" value="$(command 'xacro $(var model)')" type="str"/>
  </node>

  <node name="spawn_roselito" pkg="gazebo_ros" exec="spawn_entity.py"
    args="-entity roselito -topic /robot_description"
  />

  <arg name="map" default=""/>
  <include file="$(find-pkg-share roselito_navigation)/launch/mapping.launch" if="$(eval '\'$(var map)\' == \'\'')"/>
  <include file="$(find-pkg-share roselito_navigation)/launch/navigation.launch" if="$(eval '\'$(var map)\' != \'\'')">
    <arg name="map" value="$(var map)"/>
  </include>

  <include file="$(find-pkg-share roselito_gui)/launch/teleoperation.launch">
    <arg name="mode" value="$(eval '\'mapping\' if \'$(var map)\' == \'\' else \'localization\'')"/>
  </include>
</launch>
